<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Расширенная форма регистрации</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 20px;
        }
        
        .registration-container {
            width: 100%;
            max-width: 600px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 35px;
        }
        
        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        
        .form-group {
            margin-bottom: 20px;
            padding: 0 10px;
            flex: 1 1 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a5568;
        }
        
        .required::after {
            content: " *";
            color: #e53e3e;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="password"],
        input[type="file"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }
        
        .error {
            color: #e53e3e;
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            margin: 25px 0;
        }
        
        .checkbox-container input {
            margin-right: 10px;
        }
        
        button {
            width: 100%;
            padding: 15px;
            background-color: #4299e1;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #3182ce;
        }
        
        button:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .success-message {
            text-align: center;
            color: #38a169;
            font-weight: 500;
            margin-top: 20px;
            padding: 15px;
            background-color: #f0fff4;
            border-radius: 6px;
            display: none;
        }
        
        .input-invalid {
            border-color: #fc8181;
        }
        
        .file-info {
            font-size: 13px;
            color: #718096;
            margin-top: 5px;
        }
        
        .form-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .form-section-title {
            font-size: 20px;
            color: #2b6cb0;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #4299e1;
        }
    </style>
</head>
<body>
    <div class="registration-container">
        <h1>Регистрация аккаунта</h1>
        <form id="registrationForm">
            <!-- Персональные данные -->
            <div class="form-section">
                <div class="form-section-title">Персональные данные</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lastname" class="required">Фамилия</label>
                        <input type="text" id="lastname" placeholder="Иванов" maxlength="30">
                        <div id="lastname-error" class="error">Фамилия обязательна для заполнения</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="firstname" class="required">Имя</label>
                        <input type="text" id="firstname" placeholder="Иван" maxlength="30">
                        <div id="firstname-error" class="error">Имя обязательно для заполнения</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="middlename" class="required">Отчество</label>
                        <input type="text" id="middlename" placeholder="Иванович" maxlength="30">
                        <div id="middlename-error" class="error">Отчество обязательно для заполнения</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthdate" class="required">Дата рождения</label>
                        <input type="text" id="birthdate" placeholder="ДД.ММ.ГГГГ">
                        <div id="birthdate-error" class="error">Введите дату в формате ДД.ММ.ГГГГ</div>
                    </div>
                </div>
            </div>
            
            <!-- Контактная информация -->
            <div class="form-section">
                <div class="form-section-title">Контактная информация</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="phone" class="required">Телефон</label>
                        <input type="tel" id="phone" placeholder="+7 XXXXXX-XX-XX">
                        <div id="phone-error" class="error">Формат: +7 XXXXXX-XX-XX</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email" class="required">Электронная почта</label>
                        <input type="email" id="email" placeholder="example@mail.com">
                        <div id="email-error" class="error">Введите корректный email</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="address">Адрес проживания</label>
                    <input type="text" id="address" placeholder="Город, улица, дом" maxlength="200">
                    <div id="address-error" class="error">Максимум 200 символов</div>
                </div>
            </div>
            
            <!-- Информация об аккаунте -->
            <div class="form-section">
                <div class="form-section-title">Информация об аккаунте</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="account-type">Тип аккаунта</label>
                        <select id="account-type">
                            <option value="">Выберите тип</option>
                            <option value="individual">Физическое лицо</option>
                            <option value="legal">Юридическое лицо</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="password" class="required">Пароль</label>
                        <input type="password" id="password" placeholder="Придумайте пароль">
                        <div id="password-error" class="error">Минимум 8 символов, буквы и цифры</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="photo">Фото профиля</label>
                    <input type="file" id="photo" accept=".jpg, .jpeg, .png, .gif, .doc, .docx">
                    <div class="file-info">Макс. размер: 2 МБ (JPG, PNG, GIF, DOC)</div>
                    <div id="photo-error" class="error"></div>
                </div>
            </div>
            
            <!-- Соглашение -->
            <div class="checkbox-container">
                <input type="checkbox" id="terms">
                <label for="terms" class="required">Я согласен с условиями пользования</label>
            </div>
            <div id="terms-error" class="error">Необходимо ваше согласие</div>
            
            <button type="submit" id="submit-btn" disabled>Зарегистрироваться</button>
            <div id="success-message" class="success-message">Регистрация успешно завершена!</div>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Элементы формы
            const form = document.getElementById('registrationForm');
            const lastNameInput = document.getElementById('lastname');
            const firstNameInput = document.getElementById('firstname');
            const middleNameInput = document.getElementById('middlename');
            const birthdateInput = document.getElementById('birthdate');
            const phoneInput = document.getElementById('phone');
            const emailInput = document.getElementById('email');
            const addressInput = document.getElementById('address');
            const passwordInput = document.getElementById('password');
            const photoInput = document.getElementById('photo');
            const termsCheckbox = document.getElementById('terms');
            const submitBtn = document.getElementById('submit-btn');
            const successMessage = document.getElementById('success-message');
            
            // Элементы ошибок
            const lastNameError = document.getElementById('lastname-error');
            const firstNameError = document.getElementById('firstname-error');
            const middleNameError = document.getElementById('middlename-error');
            const birthdateError = document.getElementById('birthdate-error');
            const phoneError = document.getElementById('phone-error');
            const emailError = document.getElementById('email-error');
            const addressError = document.getElementById('address-error');
            const passwordError = document.getElementById('password-error');
            const photoError = document.getElementById('photo-error');
            const termsError = document.getElementById('terms-error');
            
            // Флаги валидности
            let isLastNameValid = false;
            let isFirstNameValid = false;
            let isMiddleNameValid = false;
            let isBirthdateValid = false;
            let isPhoneValid = false;
            let isEmailValid = false;
            let isAddressValid = true; // необязательное поле
            let isPasswordValid = false;
            let isPhotoValid = true; // необязательное поле
            let isTermsAccepted = false;
            
            // Валидация при вводе
            lastNameInput.addEventListener('input', validateLastName);
            firstNameInput.addEventListener('input', validateFirstName);
            middleNameInput.addEventListener('input', validateMiddleName);
            birthdateInput.addEventListener('input', validateBirthdate);
            phoneInput.addEventListener('input', validatePhone);
            emailInput.addEventListener('input', validateEmail);
            addressInput.addEventListener('input', validateAddress);
            passwordInput.addEventListener('input', validatePassword);
            photoInput.addEventListener('change', validatePhoto);
            termsCheckbox.addEventListener('change', validateTerms);
            
            // Валидация фамилии
            function validateLastName() {
                const value = lastNameInput.value.trim();
                isLastNameValid = value.length > 0 && value.length <= 30;
                
                if (!isLastNameValid) {
                    showError(lastNameInput, lastNameError, value.length === 0 ? 
                        'Фамилия обязательна для заполнения' : 
                        'Максимум 30 символов');
                } else {
                    clearError(lastNameInput, lastNameError);
                }
                validateForm();
            }
            
            // Валидация имени
            function validateFirstName() {
                const value = firstNameInput.value.trim();
                isFirstNameValid = value.length > 0 && value.length <= 30;
                
                if (!isFirstNameValid) {
                    showError(firstNameInput, firstNameError, value.length === 0 ? 
                        'Имя обязательно для заполнения' : 
                        'Максимум 30 символов');
                } else {
                    clearError(firstNameInput, firstNameError);
                }
                validateForm();
            }
            
            // Валидация отчества
            function validateMiddleName() {
                const value = middleNameInput.value.trim();
                isMiddleNameValid = value.length > 0 && value.length <= 30;
                
                if (!isMiddleNameValid) {
                    showError(middleNameInput, middleNameError, value.length === 0 ? 
                        'Отчество обязательно для заполнения' : 
                        'Максимум 30 символов');
                } else {
                    clearError(middleNameInput, middleNameError);
                }
                validateForm();
            }
            
            // Валидация даты рождения
            function validateBirthdate() {
                const value = birthdateInput.value.trim();
                const datePattern = /^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/;
                isBirthdateValid = datePattern.test(value);
                
                if (!isBirthdateValid && value.length > 0) {
                    showError(birthdateInput, birthdateError, 'Формат: ДД.ММ.ГГГГ');
                } else {
                    clearError(birthdateInput, birthdateError);
                }
                validateForm();
            }
            
            // Валидация телефона (теперь разрешены буквы)
            function validatePhone() {
                const value = phoneInput.value.trim();
                // Разрешаем любые символы, но сохраняем формат +7 XXXXXX-XX-XX
                const phonePattern = /^\+7\s?[a-zA-Zа-яА-Я0-9]{6}-[a-zA-Zа-яА-Я0-9]{2}-[a-zA-Zа-яА-Я0-9]{2}$/;
                isPhoneValid = phonePattern.test(value);
                
                if (!isPhoneValid && value.length > 0) {
                    showError(phoneInput, phoneError, 'Формат: +7 XXXXXX-XX-XX');
                } else {
                    clearError(phoneInput, phoneError);
                }
                validateForm();
            }
            
            // Валидация email
            function validateEmail() {
                const value = emailInput.value.trim();
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                isEmailValid = emailPattern.test(value);
                
                if (!isEmailValid && value.length > 0) {
                    showError(emailInput, emailError, 'Введите корректный email');
                } else {
                    clearError(emailInput, emailError);
                }
                validateForm();
            }
            
            // Валидация адреса
            function validateAddress() {
                const value = addressInput.value.trim();
                isAddressValid = value.length <= 200;
                
                if (!isAddressValid) {
                    showError(addressInput, addressError, 'Максимум 200 символов');
                } else {
                    clearError(addressInput, addressError);
                }
                validateForm();
            }
            
            // Валидация пароля
            function validatePassword() {
                const password = passwordInput.value;
                const hasLetters = /[a-zA-Zа-яА-Я]/.test(password);
                const hasNumbers = /[0-9]/.test(password);
                
                isPasswordValid = password.length >= 8 && hasLetters && hasNumbers;
                
                if (!isPasswordValid && password.length > 0) {
                    showError(passwordInput, passwordError, 
                        'Минимум 8 символов, включая буквы и цифры');
                } else {
                    clearError(passwordInput, passwordError);
                }
                validateForm();
            }
            
            // Валидация фото
            function validatePhoto() {
                if (photoInput.files.length > 0) {
                    const file = photoInput.files[0];
                    const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
                    const maxSizeMB = 2;
                    
                    // Проверка типа файла
                    if (!validTypes.includes(file.type)) {
                        showError(photoInput, photoError, 'Допустимы JPG, PNG, GIF, DOC');
                        isPhotoValid = false;
                        return;
                    }
                    
                    // Проверка размера файла
                    if (file.size > maxSizeMB * 1024 * 1024) {
                        showError(photoInput, photoError, `Максимальный размер: ${maxSizeMB} МБ`);
                        isPhotoValid = false;
                        return;
                    }
                    
                    clearError(photoInput, photoError);
                    isPhotoValid = true;
                } else {
                    isPhotoValid = true; // Фото необязательно
                }
                validateForm();
            }
            
            // Валидация согласия
            function validateTerms() {
                isTermsAccepted = termsCheckbox.checked;
                
                if (!isTermsAccepted) {
                    termsError.style.display = 'block';
                } else {
                    termsError.style.display = 'none';
                }
                validateForm();
            }
            
            // Проверка всей формы
            function validateForm() {
                const isValid = isLastNameValid && isFirstNameValid && 
                              isMiddleNameValid && isBirthdateValid && 
                              isPhoneValid && isEmailValid && 
                              isAddressValid && isPasswordValid && 
                              isPhotoValid && isTermsAccepted;
                
                submitBtn.disabled = !isValid;
            }
            
            // Показать ошибку
            function showError(input, errorElement, message) {
                input.classList.add('input-invalid');
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
            
            // Скрыть ошибку
            function clearError(input, errorElement) {
                input.classList.remove('input-invalid');
                errorElement.style.display = 'none';
            }
            
            // Обработка отправки формы
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Дополнительная проверка перед отправкой
                validateLastName();
                validateFirstName();
                validateMiddleName();
                validateBirthdate();
                validatePhone();
                validateEmail();
                validateAddress();
                validatePassword();
                validatePhoto();
                validateTerms();
                
                if (submitBtn.disabled) return;
                
                // Здесь должна быть отправка данных на сервер
                // Покажем сообщение об успехе
                successMessage.style.display = 'block';
                submitBtn.disabled = true;
                
                // Сброс формы через 3 секунды
                setTimeout(() => {
                    form.reset();
                    successMessage.style.display = 'none';
                    
                    // Сброс всех ошибок
                    clearError(lastNameInput, lastNameError);
                    clearError(firstNameInput, firstNameError);
                    clearError(middleNameInput, middleNameError);
                    clearError(birthdateInput, birthdateError);
                    clearError(phoneInput, phoneError);
                    clearError(emailInput, emailError);
                    clearError(addressInput, addressError);
                    clearError(passwordInput, passwordError);
                    clearError(photoInput, photoError);
                    termsError.style.display = 'none';
                    
                    // Сброс флагов валидности
                    isLastNameValid = isFirstNameValid = isMiddleNameValid = 
                    isBirthdateValid = isPhoneValid = isEmailValid = 
                    isPasswordValid = isTermsAccepted = false;
                    isAddressValid = isPhotoValid = true;
                    
                    validateForm();
                }, 3000);
            });
            
            // Маска для телефона (теперь разрешает буквы)
            phoneInput.addEventListener('input', (e) => {
                let value = e.target.value;
                
                // Сохраняем +7 в начале
                if (!value.startsWith('+7')) {
                    if (value.length > 0 && !value.startsWith('+')) {
                        value = '+7 ' + value.substring(1);
                    } else if (value.length === 1 && value !== '+') {
                        value = '+7' + value;
                    } else if (value.length === 2 && value !== '+7') {
                        value = '+7 ' + value.substring(2);
                    }
                }
                
                // Форматируем остальную часть с сохранением всех символов
                if (value.length > 4) {
                    value = value.substring(0, 4) + value.substring(4).replace(/\s|-/g, '');
                    
                    if (value.length > 4) {
                        value = value.substring(0, 4) + ' ' + value.substring(4);
                    }
                    if (value.length > 11) {
                        value = value.substring(0, 11) + '-' + value.substring(11);
                    }
                    if (value.length > 14) {
                        value = value.substring(0, 14) + '-' + value.substring(14);
                    }
                }
                
                e.target.value = value.substring(0, 16);
            });
            
            // Маска для даты рождения
            birthdateInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.length > 2) {
                    value = value.substring(0, 2) + '.' + value.substring(2);
                }
                if (value.length > 5) {
                    value = value.substring(0, 5) + '.' + value.substring(5);
                }
                
                e.target.value = value.substring(0, 10);
            });
        });
    </script>
</body>
</html>
